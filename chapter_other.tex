\chapter{Other resource}
\label{cpt:other}
\section{Introduction}
Due to the complexity of financial market and the interconnect- edness and interdependencies of industry sectors in the economy, the price returns of each coupling stocks might have certain underlying economic link. Such behaviours can hardly be explained by tradi- tional financial models and theories. This project combines machine learning techniques, individual stock features, and empirical data of Industry Economic Accounts (IEAs) from Bureau of Economic Anal- ysis (BEA) in the US to predict Granger causality of coupling US stocks. Limited Granger causalities are calculated as a small sample set compared to the target date set. A directed weighted complex network (DWCN) is constructed by considering companies as nodes, correlations of abnormal stock returns (alpha) as weights of links, and predicted Granger causalities indicate directions of links. The generated DWCN is visualised and its topological properties, sta- bility, and effects on individual stocks and industries are researched in this paper. Suggestions towards financial market investment are provided based on the results of this research.

\subsection{Motivation}
Conducting Granger causality test between stock pairs is straightforward but not feasible due to the heavy-precondition and time-complexity in programme. Compared to the large order of magnitude of total stock pairs, manually calculated Granger causalities are too less to be used as training samples. Enlightened by the recent work by Jean et al. [3] which uses transfer learning and noisy proxy information performed very well at predicting poverties, demonstrating that machine learning techniques is powerful to be applied in a setting with limited training data, so an exploration towards the directed network of stock market is motivated in this project, combines machine learning techniques, transfer learning, individual stock features, and empirical data of Industry Economic Accounts (IEAs) from Bureau of Economic Analysis (BEA) in the US to predict Granger causality of coupling US stocks. Therefore, a directed weighted complex network is constructed by considering companies as nodes, correlations of abnormal stock returns (alpha) as weights of links, and predicted Granger causalities as the indications of directions of links.

\subsection{Objectives}
The goal of the attempt in this chapter is to reveal the Granger causality of price return series and utilise them into the topological analysis and visualisation of directed complex networks as so far no previous work has attempted to construct a directed network about stock markets. In addition, suggestions for stock market can be provided according to the results and findings.

\subsection{Methodology}
\subsection{Technical Challenges in the Pre-processing for Network Construction}
A preliminary correlation matrix is generated for the co-integration test of two price return time series. Bivariate Granger causality test is prerequisite-heavy and its time-complexity in programme is much more than that of linear correlation. This is the most important point to be solved, since the amount of all coupling stock pair is $n(n-1)/2$, while $n$ is the number of stocks. There are over 3,000 company listings in NASDAQ, hence millions of times for Granger causality tests and pre-processes should run in programme in order to construct the directed network.

However, in this paper, machine learning technique is applied to predict the precedence relations i.e. predicted Granger causalities of every possible US stock pairs, based on a limited amount of actual Granger causalities calculated as training set. Fundamental indicators such as market capitalisation, P/B ratio, etc., plus public empirical data of Industry Economic Accounts (IEAs) from Bureau of Economic Analysis (BEA) \cite{beawebsite} in the US, are applied into the whole machine learning processes. Stocks are divided into industry groups according to the summary level defined in the IEAs. Transfer learning is also applied and will be mentioned at Chapter 3.3.  In addition, learning performance of each models are compared based on their predicting performance according to the ROC analysis.

\subsection{Granger Causality Test}
Granger causality test \cite{granger} provides an asymmetrical measure for testing precedence relationship between two time series. The leitmotiv inside is that a time series can be described and analysed through a time-delayed auto-regressive model. Granger causality test tests whether the difference of a prediction to the time series from another time series through a multi-variate auto-regressive model is able to improve the prediction of the current behaviour of the time series, as the following forms illustrates:

\begin{eqnarray}
&&	x_t=\sum_{i=1}^{\infty}a_ix_{t-i}+c+\varepsilon_{t}\\
&&x_t=\sum_{i=1}^{\infty}a_ix_{t-i}+\sum_{j=1}^{\infty}b_jy_{t-j}+c'+\varepsilon_{t}'
\end{eqnarray}

Calculate the f-statistic using the following equation, the Granger causality is not significant if f-statistic is greater than the f-value:
\begin{eqnarray}
&&	F=\frac{(ESS_R-ESS_{UR})/q}{ESS_{UR}/(n-k)}
\end{eqnarray}

\subsection{Transfer Learning}
Financial data of listed companies and fundamental economical data are both available in each stock market and government websites. Efforts have been taken upon the researches such as the work of Patel et al. \cite{deterministic}, which applied machine learning techniques to predict stock price movement, but most of them use correlations between stock price or return series, such measures are unable to provide direction information for building a directed graph of stock market. Granger causality test is one suitable measure but the computation is overwhelmingly complex so that no researchers have ever implemented this.

This project has probed into the feasibility of applying machine learning techniques helping to predict Granger causality based on samples of Granger causalities that have been manually calculated. Here the word “predict” means estimation of some property that is not directly observed, rather than its common meaning of inferring something about the future. Unfortunately, over 3,000 listed companies yielding couples many orders of magnitude larger than the amount of sample data for human-beings can ever calculate. The scarcity of training data on these outcomes makes the application of machine learning techniques challenging.

This project overcome this challenge through a multi-step “transfer learning” approach \cite{transfer}, whereby a noisy but easily obtained proxy for sectoral association, the correlations of stock pairs, and fundamental indicators of listed companies are used to train a deep learning model. The model is then used to estimate Granger causalities based on very limited samples through a transferring process.
% theoretical and practical

\section{Results}
In terms of future work, stock complex networks during a longer range of years can be generated and compared in together, the periods correspond to bull, bear, and stable market can be recognised and analysed separately and accordingly. New methods for determining the directions of edges to generate directed complex networks are expected to be proposed.

\section{Considerations}
